# オーディオ/ビジュアル効果機能 - クイックスタートガイド

## 🎯 実装完了内容

ブラックジャックゲームにオーディオとビジュアル効果機能を実装しました。

## 📦 追加されたファイル一覧

```
apps/blackjack/
├── assets/
│   ├── audio/
│   │   ├── README.md                    # 音声ファイルの説明
│   │   └── PLACEHOLDER.txt              # 一時プレースホルダー
│   ├── css/
│   │   ├── effects.css                  # NEW: ビジュアルエフェクト
│   │   └── settings.css                 # NEW: 設定UIスタイル
│   └── js/
│       ├── sfx.js                       # NEW: 効果音管理モジュール
│       └── settings-sfx.js              # NEW: 設定UI管理
├── index.html                           # UPDATED: 新しいCSS/JSを統合
├── assets/js/game.js                    # UPDATED: 効果音とアニメーション統合
├── README.md                            # UPDATED: 新機能の説明を追加
└── AUDIO_VISUAL_EFFECTS_IMPLEMENTATION.md  # NEW: 実装ドキュメント
```

## ⚡ 即座に動作確認できる機能

### ✅ すでに動作する機能

1. **設定UI**
   - 画面右上の⚙️ボタンで設定パネルを開閉
   - 効果音/BGMのON/OFF切替
   - 音量調整スライダー
   - 動きを減らす設定

2. **ビジュアルエフェクト**
   - カード配布時のアニメーション
   - ベット配置時のパルスエフェクト
   - 勝利時の発光エフェクト
   - 敗北時のシェイクエフェクト
   - スコア増減のバウンスアニメーション

3. **設定の永続化**
   - localStorage で設定を自動保存
   - ページリロード後も設定を保持

4. **アクセシビリティ**
   - prefers-reduced-motion 対応
   - キーボード操作対応
   - ARIA ラベル

## 🔊 音声ファイルの準備（必須）

効果音を有効にするには、以下の音声ファイルを配置してください：

### 必須ファイル

```
apps/blackjack/assets/audio/
├── card-flip.mp3    # カード配布/引く音
├── chip.mp3         # ベット配置音
├── win.mp3          # 勝利時の音
├── lose.mp3         # 敗北時の音
└── bust.mp3         # バースト/破産時の音
```

### オプションファイル

```
apps/blackjack/assets/audio/
├── stand.mp3        # スタンド時の音
└── bgm.mp3          # 背景音楽
```

### 音声ファイルの入手方法

以下のサイトから著作権フリーの音声素材を入手できます：

- [freesound.org](https://freesound.org/)
- [zapsplat.com](https://www.zapsplat.com/)
- [mixkit.co](https://mixkit.co/free-sound-effects/)

**推奨設定:**
- フォーマット: MP3
- サイズ: 効果音は20KB以下、BGMは500KB以下
- 長さ: 効果音は1秒以下

## 🚀 起動方法

### 1. ローカルサーバーで起動

```powershell
# ディレクトリに移動
cd c:\Users\toaki\development\projects\app-with-opal\app-with-opal\apps\blackjack

# Pythonサーバーで起動（例）
python -m http.server 8000

# または Node.jsの場合
npx serve .
```

### 2. ブラウザでアクセス

```
http://localhost:8000/index.html
```

### 3. 設定パネルを開く

画面右上の⚙️ボタンをクリック

## 🎮 動作確認手順

### Phase 1: ビジュアルエフェクトの確認

1. ✅ ゲームを開く
2. ✅ チップをクリック → ベット額が跳ねるアニメーション
3. ✅ Dealをクリック → カードが配られるアニメーション
4. ✅ 勝利 → プレイヤーエリアが光る
5. ✅ 敗北 → プレイヤーエリアが揺れる

### Phase 2: 設定UIの確認

1. ✅ ⚙️ボタンをクリック → 設定パネルが開く
2. ✅ 各設定を変更 → 即座に反映される
3. ✅ ページをリロード → 設定が保持される

### Phase 3: 効果音の確認（音声ファイル配置後）

1. 🔊 チップをクリック → `chip` 音が鳴る
2. 🔊 Dealをクリック → `card-flip` 音が鳴る
3. 🔊 Hitをクリック → `card-flip` 音が鳴る
4. 🔊 勝利 → `win` 音が鳴る
5. 🔊 敗北 → `lose` 音が鳴る
6. 🔊 バースト → `bust` 音が鳴る

### Phase 4: 動きを減らすモード

1. ✅ 設定で「動きを減らす」をON
2. ✅ アニメーションが最小化される

## 📝 統合されたイベント

以下のゲームイベントに効果音とアニメーションが統合されています：

| イベント | 効果音 | ビジュアル |
|---------|--------|-----------|
| ベット配置 | `chip` | チップ配置エフェクト |
| カード配布 | `card-flip` | カードディールアニメーション |
| ヒット | `card-flip` | カード追加アニメーション |
| スタンド | `stand`* | - |
| バースト | `bust` | シェイク + フェード |
| 勝利 | `win` | パルス + 発光 |
| 敗北 | `lose` | シェイク + フェード |
| 破産 | `bust` | グレースケール |

*オプション

## 🔧 トラブルシューティング

### 問題: 効果音が鳴らない

**解決策:**
1. 音声ファイルが `assets/audio/` に配置されているか確認
2. ブラウザのコンソールでエラーを確認
3. 設定パネルで効果音がONになっているか確認
4. 音量が0になっていないか確認
5. ブラウザの自動再生ポリシーに注意（モバイル）

### 問題: アニメーションが動かない

**解決策:**
1. `effects.css` が正しく読み込まれているか確認
2. ブラウザの開発者ツールでCSSエラーを確認
3. 「動きを減らす」設定がOFFになっているか確認

### 問題: 設定が保存されない

**解決策:**
1. ブラウザのlocalStorageが有効か確認
2. プライベートモード/シークレットモードでないか確認
3. ブラウザのコンソールでエラーを確認

## 📚 詳細ドキュメント

より詳しい実装内容は以下のドキュメントを参照してください：

- **[AUDIO_VISUAL_EFFECTS_IMPLEMENTATION.md](./AUDIO_VISUAL_EFFECTS_IMPLEMENTATION.md)** - 実装詳細
- **[assets/audio/README.md](./assets/audio/README.md)** - 音声ファイルガイド
- **[README.md](./README.md)** - アプリ全体の説明

## ✅ 受け入れ条件

- [x] Phase 1: 準備（ファイル構造、スケルトン実装）
- [x] Phase 2: 基本連携（主要イベントへの効果音統合）
- [x] Phase 3: ビジュアル効果（カードアニメ、勝敗エフェクト）
- [x] Phase 4: 設定UI（ON/OFF、音量、動きを減らす）
- [x] Phase 5: ドキュメント作成

## 🎉 次のステップ

1. **音声ファイルを準備**
   - 上記の推奨サイトから音声素材をダウンロード
   - `assets/audio/` に配置
   - ファイル名を仕様通りにリネーム

2. **ブラウザでテスト**
   - すべての効果音が正しく再生されるか確認
   - モバイルでもテスト

3. **PR作成の準備**
   - スクリーンショット/動画を撮影
   - 実装メモをまとめる

---

**作成日**: 2025年10月20日  
**ブランチ**: `apps/blackjack/feature/audio-visual-effects`  
**ステータス**: ✅ 実装完了（音声ファイルの配置待ち）
